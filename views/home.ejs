<meta name="xm-bind-id-client_id" content="ea854282.0bee69f4.tid_671f9079.bindid.io">




<script src="https://polyfill.io/v3/polyfill.min.js?features=Promise%2CPromise.prototype.finally%2CTextDecoder%2CTextEncoder%2CObject.entries"></script>
<script src="https://signin.bindid-sandbox.io/bindid-sdk/transmit-bind-id-sdk.js" defer></script>
<link href="./static/css/home.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">

<script>

    var url = window.location;

    var code = new URLSearchParams(url.search).get("code");
    console.log(code)

    function sendAuthCodeToServer(authCode) {

        const XHR = new XMLHttpRequest();
        XHR.addEventListener("load", (event) => {
            alert("Datos Enviados!")
        })

        XHR.addEventListener("error", (event) => {
            alert("Error Enviando los datos.")
        })

        XHR.open("POST",);
        XHR.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
        var data = new FormData()
        data.append("data")
        XHR.send(code)
        
        
    }
    function handleError(err) {
        console.log(err.message)
     // Add code to process the authentication error here
    }

    window.XmBindId.processRedirectResponse()
     .then(res => { sendAuthCodeToServer(res.code); },
         err => { handleError(err); })

    function sendData(){
        const XHR = new XMLHttpRequest();
        XHR.open("POST", "/auth", true);
        XHR.setRequestHeader("Content-Type", "application/json;charset=UTF-8");
        var data = new FormData()
        data.append("code" , code)
        XHR.send(JSON.stringify({
            "code" : code
        }));
        
    }
         

  </script>



<body class="d-flex h-100 text-center text-white bg-dark">
    
    <div class="cover-container d-flex w-100 h-100 p-3 mx-auto flex-column">
        
        
        <main class="px-3">
            
            <h1>Bienvenido, </h1>
            <h3>Pagina Home, Primera Autenticacion Verificada</h3>
            <p class="lead">Ahora nos queda solicitar la informacion del Usuario a BIND ID</p>
            <button class="w-100 btn btn-lg btn-info" onclick="sendData()"> Solicitar Datos del Usuario</button>
            
        </main>
    
      <footer class="mt-auto text-white-50">
        <p>Desde VR4, para nuestros clientes.</p>
      </footer>
      
       
    </div>
